<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Kürtçe Fiil Çekimi</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <style>
    body { min-height: 100vh; }
  </style>
</head>
<body class="min-h-screen bg-pink-50 text-purple-900 flex flex-col items-center justify-start p-6 gap-6">

  <h1 class="text-3xl font-bold text-pink-600">Kürtçe Fiil Çekimi</h1>

  <label for="verb-select" class="font-semibold text-purple-700">Fiil seçin:</label>
  <select id="verb-select" class="rounded-md border border-pink-300 p-2 text-purple-800 bg-white shadow-sm max-w-xs focus:outline-none focus:ring-2 focus:ring-pink-400">
    <!-- options will be populated dynamically -->
  </select>

  <div id="conjugation-container" class="max-w-4xl w-full bg-white rounded-2xl shadow-xl p-6 space-y-6 border border-purple-100">
    <!-- conjugation table will appear here -->
  </div>

  <script>
    const persons = ["ez", "tu", "ew", "em", "hûn", "ew (pl.)"];
    const verbSelect = document.getElementById("verb-select");
    const conjugationContainer = document.getElementById("conjugation-container");

    let verbs = {};

    fetch('Kurdish_Verbs.csv')
      .then(response => response.text())
      .then(csvText => {
        const parsed = Papa.parse(csvText, { header: true, skipEmptyLines: true });
        buildVerbsObject(parsed.data);
        populateDropdown();
        renderTable(verbSelect.value);
      })
      .catch(err => {
        conjugationContainer.innerHTML = "<p class='text-red-600'>CSV dosyası yüklenirken hata oluştu.</p>";
        console.error("Error loading CSV:", err);
      });

    function buildVerbsObject(data) {
      data.forEach(row => {
        verbs[row.verb] = {
          definition: row.definition,
          conjugations: {
            present: [
              row.present_1, row.present_2, row.present_3,
              row.present_4, row.present_5, row.present_6
            ],
            presentNegative: [
              row.presentNegative_1, row.presentNegative_2, row.presentNegative_3,
              row.presentNegative_4, row.presentNegative_5, row.presentNegative_6
            ],
            past: [
              row.past_1, row.past_2, row.past_3,
              row.past_4, row.past_5, row.past_6
            ],
            future: [
              row.future_1, row.future_2, row.future_3,
              row.future_4, row.future_5, row.future_6
            ]
          }
        };
      });
    }

    function populateDropdown() {
      verbSelect.innerHTML = '';
      for (const verb in verbs) {
        const option = document.createElement("option");
        option.value = verb;
        option.textContent = `${verb} (${verbs[verb].definition})`;
        verbSelect.appendChild(option);
      }
      verbSelect.addEventListener("change", e => renderTable(e.target.value));
    }

    function renderTable(verb) {
      if (!verb || !verbs[verb]) {
        conjugationContainer.innerHTML = "<p>Fiil seçiniz.</p>";
        return;
      }
      const v = verbs[verb].conjugations;
      conjugationContainer.innerHTML = `
        <h2 class="text-xl font-semibold text-pink-700">
          Fiil: <span class="italic">${verb}</span> (${verbs[verb].definition})
        </h2>
        <div class="overflow-x-auto">
          <table class="min-w-full border border-pink-200 rounded-md text-sm">
            <thead class="bg-pink-100 text-purple-800">
              <tr>
                <th class="p-2 border border-pink-300 text-left">Kişi</th>
                <th class="p-2 border border-pink-300 text-left">Şimdiki Zaman</th>
                <th class="p-2 border border-pink-300 text-left">Olumsuz</th>
                <th class="p-2 border border-pink-300 text-left">Geçmiş Zaman</th>
                <th class="p-2 border border-pink-300 text-left">Gelecek Zaman</th>
              </tr>
            </thead>
            <tbody class="text-purple-900">
              ${persons.map((person, i) => `
                <tr class="hover:bg-pink-50">
                  <td class="p-2 border border-pink-200">${person}</td>
                  <td class="p-2">${v.present[i]}</td>
                  <td class="p-2">${v.presentNegative[i]}</td>
                  <td class="p-2">${v.past[i]}</td>
                  <td class="p-2">${v.future[i]}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;
    }
  </script>

</body>
</html>
